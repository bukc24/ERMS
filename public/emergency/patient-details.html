<!DOCTYPE html>
<html lang="en">


<!-- index22:59-->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
    <base href="/">
    <link rel="shortcut icon" type="image/x-icon" href="emergency/assets/img/favicon.ico">
    <title>Emergency Management</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="emergency/assets/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="emergency/assets/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="emergency/assets/css/style.css">
    <!--[if lt IE 9]>
		<script src="emergency/assets/js/html5shiv.min.js"></script>
		<script src="emergency/assets/js/respond.min.js"></script>
	<![endif]-->

</head>

<body>
    <div class="main-wrapper">
        <div class="header">
			<div class="header-left">
				<a href="/dashboard" class="logo">
					<img src="emergency/assets/img/logo.png" width="35" height="35" alt=""> <span>Emergency</span>
				</a>
			</div>
			<a id="toggle_btn" href="javascript:void(0);"><i class="fa fa-bars"></i></a>
            <a id="mobile_btn" class="mobile_btn float-left" href="#sidebar"><i class="fa fa-bars"></i></a>
            <ul class="nav user-menu float-right">
                
                <li class="nav-item dropdown has-arrow">
                    <a href="#" class="dropdown-toggle nav-link user-link" data-toggle="dropdown">
                        <span class="user-img">
							<img class="rounded-circle" src="emergency/assets/img/user.jpg" width="24" alt="Admin">
							<span class="status online"></span>
						</span>
						<span>Admin</span>
                    </a>
					<div class="dropdown-menu">
						<a class="dropdown-item" href="profile.html">My Profile</a>
						<a class="dropdown-item" href="edit-profile.html">Edit Profile</a>
						<a class="dropdown-item" href="settings.html">Settings</a>
						<a class="dropdown-item" href="/logout">Logout</a>
					</div>
                </li>
            </ul>
            <div class="dropdown mobile-user-menu float-right">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><i class="fa fa-ellipsis-v"></i></a>
                <div class="dropdown-menu dropdown-menu-right">
                    <a class="dropdown-item" href="profile.html">My Profile</a>
                    <a class="dropdown-item" href="edit-profile.html">Edit Profile</a>
                    <a class="dropdown-item" href="settings.html">Settings</a>
                    <a class="dropdown-item" href="/logout">Logout</a>
                </div>
            </div>
        </div>
        <div class="sidebar" id="sidebar">
            <div class="sidebar-inner slimscroll">
                <div id="sidebar-menu" class="sidebar-menu">
                    <ul>
                        <li class="menu-title">Main</li>
                        <li>
                            <a href="/dashboard"><i class="fa fa-dashboard"></i> <span>Dashboard</span></a>
                        </li>
						<li>
                            <a href="/emergency_call"><i class="fa fa-user-md"></i> <span>Emergency Call</span></a>
                        </li>
                        <li>
                            <a href="/register"><i class="fa fa-wheelchair"></i> <span>Patient Register</span></a>
                        </li>
                        <li>
                            <a href="/admit"><i class="fa fa-calendar"></i> <span>Patient Admit</span></a>
                        </li>

                    </ul>
                </div>
            </div>
        </div>
        <div class="page-wrapper">
            <div class="content">
                <div class="row">
                    <div class="col-lg-8 offset-lg-2">
                        
                        <h4 class="page-title">Patient Details</h4>

                        <div class="nav-item dropdown has-arrow float-right">
                            <a href="#" class="dropdown-toggle btn btn-primary" data-toggle="dropdown">
                                <span>Actions</span>
                            </a>
                            <div class="dropdown-menu">
                                <a class="dropdown-item" data-toggle="modal" data-target="#medicalHistory" href="">View Medical History</a>
                                <a class="dropdown-item" data-toggle="modal" data-target="#diagnosisHistory" href="">View Diagnosis History</a>
                                <a class="dropdown-item" data-toggle="modal" data-target="#labTestHistory" href="">View Lab Test History</a>
                                <a class="dropdown-item" data-toggle="modal" data-target="#updateStatus" href="">Update Patient Status</a>
                                <a class="dropdown-item" data-toggle="modal" data-target="#labTestRequest" href="">Lab Test Request</a>
                                <a class="dropdown-item" data-toggle="modal" data-target="#medicineRequest" href="">Medicine Request</a>
                            </div>
                        </div>
                        

                    </div>
                </div>
                <div class="row">
                    
                    <div class="col-lg-8 offset-lg-2">

                        <form>
                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label>Patient ID</label>
                                        <input id='id' name="id" class="form-control" type="text" readonly>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label>Patient Name </label>
                                        <input id="name" name="name" class="form-control" type="text" readonly>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label>Date of Birth </label>
                                        <div class="cal-icon">
                                            <input id="dob" name="dob" type="text" class="form-control datetimepicker" readonly>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label>Contact No. </label>
                                        <input id='contact' name="contact" class="form-control" type="text" readonly>
                                    </div>
                                </div>
                                <div class="col-sm-6">
									<div class="form-group gender-select">
										<label class="gen-label">Gender:</label>
										<div class="form-check-inline">
											<label class="form-check-label">
												<input id="gender-male" type="radio" name="gender" value="M" class="form-check-input" disabled>Male
											</label>
										</div>
										<div class="form-check-inline">
											<label class="form-check-label">
												<input id="gender-female" type="radio" name="gender" value="F" class="form-check-input" disabled>Female
											</label>
										</div>
									</div>
                                </div>
								<div class="col-sm-12">
									<div class="row">
										<div class="col-sm-12">
											<div class="form-group">
												<label>Address</label>
												<input id="address" name="address" type="text" class="form-control " readonly>
											</div>
										</div>											
									</div>
								</div>
                                
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label>Triage </label>
                                        <select id='triage' name="triage" class="form-control" disabled>
                                            <option value="">Select a triage level</option>
                                            <option value="Red">Red - Immediate</option>
                                            <option value="Yellow">Yellow - Urgent</option>
                                            <option value="Green">Green - Non-Urgent</option>
                                            <option value="Black">Black - Deceased</option>
                                        </select>
                                    </div>
                                </div>
                               
                                
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label>Doctor Assigned</label>
                                        <input id='doctor' name="doctor" class="form-control" type="text" readonly>
                                    </div>
                                </div>
                                <div class="col-sm-12">
                                    <div class="form-group">
                                        <label>Description </label>
                                        <input id='description' name="description" class="form-control" type="text-area" readonly>
                                    </div>
                                </div>
                            </div>
                            
                        </form>
                    </div>
                </div>

                <div class="row">
                    <div class="col-lg-5"></div>
                    <div class="col-lg-1 mx-1">
                        <div class="m-t-20 text-center">
                            <button class="btn btn-danger" data-toggle="modal" data-target="#dischargeModal">Discharge</button>
                        </div>
                    </div>
                    <div class="col-lg-1 mx-1">
                        <div class="m-t-20 text-center">
                            <button class="btn btn-dark" data-toggle="modal" data-target="#deceasedModal">Deceased</button>
                        </div>
                    </div>
                    <div class="col-lg-5"></div>
                </div>

                

                <!-- POPUPS-->

                <!-- Modal --> 
                <div class="modal fade bd-example-modal-lg" id="medicalHistory" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
                    <div class="modal-dialog  modal-dialog-centered modal-lg">
                      <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Diagnosis History</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                            </div>
                            <div class="modal-body">
                                <table id="medical-history-table" class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>TreatmentHistory</th>
                                            <th>Allergies</th>
                                            <th>PreviousSurgeries</th>
                                            <th>FamilyHistory</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Diagnosis items will be added here -->
                                    </tbody>
                                </table>
                            </div>
                            <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            </div>
                      </div>
                    </div>
                  </div>    
                <!-- Modal -->      
                <div class="modal fade" id="diagnosisHistory" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Diagnosis History</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        </div>
                        <div class="modal-body">
                            <table id="diagnosis-table" class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Diagnosis</th>
                                        <th>Clinical Notes</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Diagnosis items will be added here -->
                                </tbody>
                            </table>
                        </div>
                        <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                    </div>
                </div>
                <!-- Modal -->
                <div class="modal fade" id="labTestHistory" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Lab Tests</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        </div>
                        <div class="modal-body">
                            <table id="lab-test-table" class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Test Name</th>
                                        <th>Field Name</th>
                                        <th>Normal Range</th>
                                        <th>Result</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Lab test items will be added here -->
                                </tbody>
                            </table>
                        </div>
                        <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                    </div>
                </div>
                <!-- Modal -->
                <div class="modal fade" id="updateStatus" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Update Status</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        </div>
                        <div class="modal-body">
                            <form id='updateForm'>
                                <div class="row">
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Status </label>
                                            <select id='statusUpdate' name="status" class="form-control">
                                                <option value="">Select Status</option>
                                                <option value="Admitted">Admitted</option>
                                                <option value="In Treatment">In Treatment</option>
                                                <option value="Undergoing Operation">Undergoing Operation</option>
                                            </select>
                                        </div>
                                    </div>                                    
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Triage <span class="text-danger">*</span></label>
                                            <select id='triageUpdate' name="triage" class="form-control">
                                                <option value="">Select a triage level</option>
                                                <option value="Red">Red - Immediate</option>
                                                <option value="Yellow">Yellow - Urgent</option>
                                                <option value="Green">Green - Non-Urgent</option>
                                                <option value="Black">Black - Deceased</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Doctors</label>
                                            <select id='doctorUpdate' name="doctor" class="form-control">
                                                <!-- Options will be populated here dynamically -->
                                                <option value="">Select Doctor</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label>Description </label>
                                            <input id='descriptionUpdate' name="description" class="form-control" type="text-area" >
                                        </div>
                                    </div>
                                    
                                </div>
                                
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                    <input type="submit" class="btn btn-primary" value="Save changes">
                                    </div>
                            </form>
                        </div>
                        
                    </div>
                    </div>
                </div>
                <!-- Modal -->
                <div class="modal fade" id="labTestRequest" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Lab Test Request</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        </div>
                        <div class="modal-body">
                        ...
                        </div>
                        <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                        </div>
                    </div>
                    </div>
                </div>
                <!-- Modal -->
                <div class="modal fade" id="medicineRequest" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Medicine Request</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        </div>
                        <div class="modal-body">
                        ...
                        </div>
                        <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                        </div>
                    </div>
                    </div>
                </div>

                <!-- Bootstrap Modal HTML -->
                <div class="modal fade" id="dischargeModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Discharging Patient</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <label for="dischargeReason">Reason for discharge:</label>
                                <input type="text" id="dischargeReason" class="form-control">
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                <button type="button" class="btn btn-primary" id="confirmDischarge">Confirm</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bootstrap Modal for Deceased -->
                <div class="modal fade" id="deceasedModal" tabindex="-1" role="dialog" aria-labelledby="deceasedModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="deceasedModalLabel">Update Deceased Status</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <label for="deceasedReason">Reason for death:</label>
                                <input type="text" id="deceasedReason" class="form-control">
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                <button type="button" class="btn btn-primary" id="confirmDeceased">Confirm</button>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            
            
        </div>
    </div>
    <div class="sidebar-overlay" data-reff=""></div>
    <script src="emergency/assets/js/jquery-3.2.1.min.js"></script>
	<script src="emergency/assets/js/popper.min.js"></script>
    <script src="emergency/assets/js/bootstrap.min.js"></script>
    <script src="emergency/assets/js/jquery.slimscroll.js"></script>
    <script src="emergency/assets/js/Chart.bundle.js"></script>
    <script src="emergency/assets/js/chart.js"></script>
    <script src="emergency/assets/js/app.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Extract the patient ID
            const patientId = getPatientIdFromUrl();

            populatePatientData(patientId);
            fetchDiagnosisData(patientId);
            fetchLabTestData(patientId);
            fetchMedicalHistoryData(patientId);
            populateDoctorsSelect();
            updatePatientStatus(patientId);
            confirmDischarge(patientId);
            confirmDeceased(patientId);
        });


        // Function to extract the patient ID from the URL path
        function getPatientIdFromUrl() {
            const path = window.location.pathname;
            const pathSegments = path.split('/');
            return pathSegments[pathSegments.length - 1]; // Get the last segment which is the patient ID
        }


        function populatePatientData(patientId){
            const apiURL = `api/patients_in_ER/${patientId}`;
            // Fetch data from the API
            fetch(apiURL)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok ' + response.statusText);
                    }
                    return response.json();
                })
                .then(data => {
                    //getting data entry
                    data=data[0]

                    // Populate the form fields with the data
                    document.getElementById('id').value = data.PatientID;
                    document.getElementById('name').value = data.PatientName;
                    document.getElementById('dob').value = new Date(data.DOB).toLocaleDateString();
                    document.getElementById('contact').value = data.Contact;
                    document.getElementById('address').value = data.Address;
                    document.getElementById('triage').value = data.Triage;
                    document.getElementById('doctor').value = data.DoctorName;
                    document.getElementById('description').value = data.Description || '';

                    // Set gender radio button
                    if (data.Gender === 'M') {
                        document.getElementById('gender-male').checked = true;
                    } else if (data.Gender === 'F') {
                        document.getElementById('gender-female').checked = true;
                    }
                })
                .catch(error => {
                    console.error('There was a problem with the fetch operation:', error);
                });
        }

        function fetchDiagnosisData(patientId) {
            const diagnosisApiURL = `api/patient_diagnosis_history/${patientId}`;
            fetch(diagnosisApiURL)
                .then(response => response.json())
                .then(data => populateDiagnosisTable(data))
                .catch(error => console.error('Error fetching diagnosis data:', error));
        }
        
        function populateDiagnosisTable(diagnosisData) {
            const diagnosisTableBody = document.getElementById('diagnosis-table').getElementsByTagName('tbody')[0];
            diagnosisTableBody.innerHTML = ''; // Clear existing items
            diagnosisData.forEach(diagnosis => {
                const row = diagnosisTableBody.insertRow();
                const dateCell = row.insertCell(0);
                const diagnosisCell = row.insertCell(1);
                const notesCell = row.insertCell(2);
                const descriptionCell = row.insertCell(3);
        
                dateCell.textContent = new Date(diagnosis.Date).toLocaleDateString();
                diagnosisCell.textContent = diagnosis.DiagnosisName;
                notesCell.textContent = diagnosis.ClinicalNotes;
                descriptionCell.textContent = diagnosis.Description;
            });
        }

        function fetchLabTestData(patientId) {
            const labTestApiURL = `api/patient_lab_history/${patientId}`;
            fetch(labTestApiURL)
                .then(response => response.json())
                .then(data => populateLabTestTable(data))
                .catch(error => console.error('Error fetching lab test data:', error));
        }
        
        function populateLabTestTable(labTestData) {
            const labTestTableBody = document.getElementById('lab-test-table').getElementsByTagName('tbody')[0];
            labTestTableBody.innerHTML = ''; // Clear existing items
            labTestData.forEach(test => {
                const row = labTestTableBody.insertRow();
                const dateCell = row.insertCell(0);
                const testNameCell = row.insertCell(1);
                const fieldNameCell = row.insertCell(2);
                const normalRangeCell = row.insertCell(3);
                const resultCell = row.insertCell(4);
        
                dateCell.textContent = new Date(test.timestamp).toLocaleDateString();
                testNameCell.textContent = test.Testname;
                fieldNameCell.textContent = test.FieldName;
                normalRangeCell.textContent = test.NormalRange;
                resultCell.textContent = test.FieldResult;
            });
        }

        //medical history
        function fetchMedicalHistoryData(patientId) {
            const labTestApiURL = `api/patient_history/${patientId}`;
            fetch(labTestApiURL)
                .then(response => response.json())
                .then(data => populateMedicalHistoryTable(data))
                .catch(error => console.error('Error fetching lab test data:', error));
        }
        
        function populateMedicalHistoryTable(medicalHistoryData) {
            const medicalHistoryTableBody = document.getElementById('medical-history-table').getElementsByTagName('tbody')[0];
            medicalHistoryTableBody.innerHTML = ''; // Clear existing items
            medicalHistoryData.forEach(history => {
                const row = medicalHistoryTableBody.insertRow();
                const treatmentHistory = row.insertCell(0);
                const allergies = row.insertCell(1);
                const previousSurgeries = row.insertCell(2);
                const familyHistory = row.insertCell(3);

        
                treatmentHistory.textContent = history.TreatmentHistory;
                allergies.textContent = history.Allergies;
                previousSurgeries.textContent = history.PreviousSurgeries;
                familyHistory.textContent = history.FamilyHistory;

            });

            
        }

        //doctors update
        function populateDoctorsSelect() {
            fetch('api/doctors_in_ER')
                .then(response => response.json())
                .then(data => {
                    const selectElement = document.getElementById('doctorUpdate');
                    data.forEach(doctor => {
                        const option = document.createElement('option');
                        option.value = doctor.DoctorID;
                        option.textContent = `${doctor.EmpName} - ${doctor.Specialization}`;
                        selectElement.appendChild(option);
                    });
                })
                .catch(error => {
                    console.error('Error fetching doctor data:', error);
                });
        }
    
        //update form
        function updatePatientStatus(patientId) {
            document.getElementById('updateForm').addEventListener('submit', async function(event) {
                event.preventDefault();
        
                const patientID = patientId; // You may retrieve this dynamically from your page
                const status = document.getElementById('statusUpdate').value;
                const triage = document.getElementById('triageUpdate').value;
                const doctorID = document.getElementById('doctorUpdate').value;
                const description = document.getElementById('descriptionUpdate').value;
        
                const formData = {
                    patientID: patientID,
                    status: status,
                    triage: triage,
                    doctor: doctorID,
                    description: description
                };
        
                try {
                    const response = await fetch(`/api/patient_status_update/${patientId}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(formData)
                    });
                    
                    if (response.ok) {
                        // Reload the page after successful update
                        window.location.reload();
                    } else {
                        console.error('Error updating patient status:', response.statusText);
                    }
                } catch (error) {
                    console.error('Error updating patient status:', error);
                }
            });
        }

        function confirmDischarge(patientId){
            document.getElementById('confirmDischarge').onclick = function() {
                const reason = document.getElementById('dischargeReason').value;
            
                fetch(`/api/patient_discharge/${patientId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ reason: reason })
                })
                .then(response => response.json())
                .then(data => {
                    console.log(data);
                    $('#dischargeModal').modal('hide'); // Hide the modal
                    window.location.href = '/dashboard'; // Redirect to the dashboard
                })
                .catch(error => console.error('Error:', error));
            }    
        }
    
        function confirmDeceased(patientId){
            document.getElementById('confirmDeceased').onclick = function() {
                
                const reason = document.getElementById('deceasedReason').value;
            
                fetch(`/api/patient_deceased/${patientId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ reason: reason })
                })
                .then(response => response.json())
                .then(data => {
                    console.log(data);
                    $('#deceasedModal').modal('hide'); // Hide the modal
                    window.location.href = '/dashboard'; // Redirect to the dashboard
                })
                .catch(error => console.error('Error:', error));
            }
        }
    </script>
</body>


<!-- index22:59-->
</html>